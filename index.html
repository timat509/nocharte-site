<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NOCHARTE</title>

  <!-- Redirect FIRST visit to intro.html -->
  <script>
    (function () {
      try {
        const url = new URL(location.href);
        const skip = url.searchParams.get('skip-intro') === '1';
        const played = sessionStorage.getItem('nocharte_intro_played') === '1';
        if (!skip && !played) {
          location.replace('intro.html');
        } else if (skip) {
          url.searchParams.delete('skip-intro');
          history.replaceState(null, '', url);
        }
      } catch (e) {}
    })();
  </script>

  <!-- Font & global styles -->
  <link href="https://fonts.cdnfonts.com/css/glacial-indifference" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>

<body class="home">
  <!-- HEADER -->
  <header class="nav">
    <a class="logo" href="index.html" aria-label="NOCHARTE Home">
      <img src="assets/web/logohome.png" alt="NOCHARTE">
    </a>
    <nav class="links" role="navigation">
      <a href="index.html" data-nav="home" aria-current="page">Home</a>
      <a href="gallery.html" data-nav="gallery">Gallery</a>
      <a href="about.html" data-nav="about">About</a>
      <a href="contact.html" data-nav="contact">Contact</a>
    </nav>
  </header>

  <!-- PAGE CONTENT -->
  <div class="scroller">
    <!-- HERO -->
    <main class="hero snap" id="scene">
      <div class="layer bg" data-depth="0.10" aria-hidden="true"></div>
      <div class="layer vignette" data-depth="0.14" aria-hidden="true"></div>
      <div class="layer hero-particles" data-depth="0.18" aria-hidden="true">
        <span></span><span></span><span></span><span></span><span></span>
        <span></span><span></span><span></span><span></span><span></span>
      </div>

      <div class="layer logo-holder" data-depth="0.22" aria-hidden="true">
        <img id="homeLogo" class="home-logo" src="assets/web/logohome.png" alt="NOCHARTE" />
      </div>

      <!-- Hero copy -->
      <section class="content layer lowered" data-depth="0.30">
        <h1 id="headline" class="headline">
          <span class="hword fill">WE</span>
          <span class="hword fill framed">FRAME</span>
          <span class="hword fill ind-1">THE</span>
          <span class="hword gradient ind-2">FEELING</span>
        </h1>

        <div class="cta">
          <p class="kicker">EVENT PHOTOGRAPHY</p>
          <a href="#featured" class="btn">View Gallery</a>
        </div>
      </section>

      <div class="scrolldown" aria-hidden="true"><span></span></div>
    </main>

    <!-- VISION / MISSION -->
    <section id="about" class="vm-section snap">
      <div class="container">
        <div class="vm-row">
          <div class="vm-media"><div class="vm-art"></div></div>
          <div class="vm-copy">
            <span class="eyebrow">OUR VISION</span>
            <h2 class="vm-title">NOCHARTE</h2>
            <p class="vm-text">
              NOCHARTE captures the energy and essence of nightlife through bold, artistic photography.
              We turn fleeting moments into timeless visuals that reflect the rhythm, style, and emotion
              of every event. Our vision is to redefine nightlife photography into an immersive brand
              experience people will remember and share.
            </p>
          </div>
        </div>

        <div class="vm-row vm-row--reverse">
          <div class="vm-copy">
            <span class="eyebrow">OUR MISSION</span>
            <h2 class="vm-title">Make Nightlife Unforgettable</h2>
            <p class="vm-text">
              We capture the energy, style, and emotion of every event. Our mission: create visuals
              people trust to relive and share their best moments.
              <span class="vm-pill">Speed</span>
              <span class="vm-pill">Precision</span>
              <span class="vm-pill">Trust</span>
            </p>
          </div>
          <div class="vm-media"><div class="vm-art"></div></div>
        </div>
      </div>
    </section>

    <!-- FEATURED (Recent) -->
    <section id="featured" class="featured snap">
      <div class="brand-lock" aria-hidden="true">
        <img src="assets/web/logohome.png" alt="" />
        <span>NOCHARTE</span>
      </div>

      <div class="featured__inner">
        <div class="featured__head">
          <h2>Most Recent Events</h2>
          <p>Recent nights captured by NOCHARTE</p>
        </div>

        <!-- Cards injected here -->
        <div class="grid" id="recent-albums"></div>

        <div class="more">
          <a class="btn btn--outline" href="gallery.html">Open Full Gallery</a>
        </div>
      </div>
    </section>
  </div>

  <!-- JS -->
  <script>
    // ----- OPTIONAL: GSAP parallax/scroll if GSAP exists -----
    if (window.gsap && window.ScrollTrigger) {
      gsap.registerPlugin(ScrollTrigger);

      gsap.to(".home .home-logo", {
        yPercent: -10, ease: "none",
        scrollTrigger: { trigger: ".hero", start: "top top", end: "bottom top", scrub: true }
      });

      gsap.to(".hero-particles span", {
        yPercent: -20, ease: "none",
        scrollTrigger: { trigger: ".hero", start: "top top", end: "bottom top", scrub: true }
      });

      gsap.utils.toArray(".vm-media .vm-art").forEach((el, i) => {
        gsap.fromTo(el, { y: i % 2 ? 60 : -60 }, {
          y: i % 2 ? -60 : 60, ease: "none",
          scrollTrigger: { trigger: el, start: "top bottom", end: "bottom top", scrub: true }
        });
      });

      gsap.utils.toArray(".vm-copy").forEach((el) => {
        gsap.from(el, {
          y: 40, autoAlpha: 0, duration: 0.8, ease: "power3.out",
          scrollTrigger: { trigger: el, start: "top 80%", toggleActions: "play none none reverse" }
        });
      });

      gsap.utils.toArray(".featured .art").forEach((el) => {
        gsap.fromTo(el, { y: 30, scale: 1.02 }, {
          y: -30, scale: 1, ease: "none",
          scrollTrigger: { trigger: el, start: "top bottom", end: "bottom top", scrub: true }
        });
      });

      // Brand lock triggers
      gsap.registerPlugin(ScrollTrigger);
      ScrollTrigger.create({
        trigger: "#featured",
        start: "top center",
        onEnter: () =>
          gsap.to("#headline", {
            scale: 0.38, x: -40, y: -60, transformOrigin: "left top",
            duration: 0.8, ease: "power3.out",
          }),
        onLeaveBack: () =>
          gsap.to("#headline", { scale: 1, x: 0, y: 0, duration: 0.8, ease: "power3.out" }),
      });
      ScrollTrigger.create({
        trigger: "#featured",
        start: "top center",
        onEnter: () => gsap.to(".brand-lock", { autoAlpha: 1, y: 0, duration: 0.6 }),
        onLeaveBack: () => gsap.to(".brand-lock", { autoAlpha: 0, y: -20, duration: 0.4 }),
      });
    }

    // Reveal headline words (works with or without GSAP)
    function runHeroReveal() {
      const words = document.querySelectorAll(".headline .hword");
      if (window.gsap) gsap.from(words, { y: 40, autoAlpha: 0, stagger: 0.12, duration: 0.9, ease: "power3.out" });
    }
    window.addEventListener("load", runHeroReveal);

    // Simple parallax (mouse/scroll) without external libs
    (function parallax() {
      const scene = document.getElementById("scene");
      if (!scene) return;
      const layers = [...scene.querySelectorAll(".layer")];
      let cy = innerHeight / 2, my = 0;

      function apply() {
        const sy = scrollY || pageYOffset;
        layers.forEach((el) => {
          const d = parseFloat(el.dataset.depth || 0);
          const y = sy * d * -0.25;
          const yTilt = my * d * 8;
          el.style.transform = `translate3d(0px, ${y + yTilt}px, 0)`;
        });
      }
      addEventListener("mousemove", (e) => { my = (e.clientY - cy) / cy; apply(); }, { passive: true });
      ["scroll", "load", "resize"].forEach((ev) =>
        addEventListener(ev, () => { cy = innerHeight / 2; apply(); }, { passive: true })
      );
    })();

    // Morph from intro
    (function(){
      try{
        const raw = sessionStorage.getItem('nocharte_morph');
        if(!raw) return;
        sessionStorage.removeItem('nocharte_morph');

        const m = JSON.parse(raw);
        const logo = document.getElementById('homeLogo');
        if(!logo) return;

        logo.style.opacity = '0';
        const reduce = matchMedia('(prefers-reduced-motion: reduce)').matches;
        const dst = logo.getBoundingClientRect();
        const dstCx = dst.left + dst.width/2;
        const dstCy = dst.top  + dst.height/2;

        const dx = m.cx - dstCx;
        const dy = m.cy - dstCy;
        const scale = m.w / dst.width;

        if (window.gsap && !reduce){
          gsap.set(logo, { autoAlpha:1, transformOrigin:'50% 50%', x:dx, y:dy, scale:scale, zIndex:10 });
          gsap.to(logo, { x:0, y:0, scale:1, duration:.9, ease:'power3.inOut' });
        } else {
          logo.style.opacity = '1';
        }
      }catch(_){}
    })();

    // Mark current nav link
    (function(){
      try{
        const path = (location.pathname.replace(/\/+$/, '') || '/index.html').toLowerCase();
        document.querySelectorAll('.links a').forEach(a => {
          const url = new URL(a.getAttribute('href'), location.origin);
          const p = url.pathname.replace(/\/+$/, '').toLowerCase();
          if (p === path || (p.endsWith('index.html') && (path === '' || path === '/'))) {
            a.setAttribute('aria-current', 'page');
          }
        });
      }catch(e){}
    })();

    // -------- Recent Albums (REAL DATA) --------
    (function(){
      // If you already have window.ALBUMS from another file, it will use that.
      const albums = (window.ALBUMS || [
        {
          title: "La Gloria — 23 Aug 2025",
          dateISO: "2025-08-23",
          photos: 52,
          cover: "albums/la-gloria-2025-08-23/cover.jpg",
          url:   "album-la-gloria-2025-08-23.html"
        },
        {
          title: "Luna — 19 Jul 2025",
          dateISO: "2025-07-19",
          photos: 7,
          cover: "albums/luna-2025-07-19/cover.jpg",
          url:   "album-luna-2025-07-19.html"
        },
        {
          title: "Neon Pulse — 14 Jun 2025",
          dateISO: "2025-06-14",
          photos: 96,
          cover: "albums/neon-pulse-2025-06-14/cover.jpg",
          url:   "album-neon-pulse-2025-06-14.html"
        }
        // Add more as you publish; newest 3 will show automatically
      ]);

      const recent = [...albums]
        .sort((a,b)=> new Date(b.dateISO) - new Date(a.dateISO))
        .slice(0,3);

      const grid = document.getElementById('recent-albums');
      if (!grid) return;

      grid.innerHTML = recent.map(a => `
        <a class="card" href="${a.url}" aria-label="Open ${a.title}">
          <div class="art">
            <img src="${a.cover}" alt="${a.title}" loading="lazy" />
          </div>
          <div class="meta">
            <strong>${a.title.split(' — ')[0]}</strong>
            <span>${new Date(a.dateISO).toLocaleString('en-US',{month:'short', year:'numeric'})} • ${a.photos} photos</span>
          </div>
        </a>
      `).join('');
    })();
  </script>
</body>
</html>
